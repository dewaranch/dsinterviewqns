<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Statistics" href="Statistics.html" /><link rel="prev" title="Basics" href="Basics.html" />

    <link rel="shortcut icon" href="../../_static/logo.gif"/><meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>Data Manipulation - The Data Science Interview Book</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../intro.html"><div class="brand">The Data Science Interview Book</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../../intro.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/logo.gif" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">The Data Science Interview Book</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">To Do</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../To%20Do%20List.html">To Do</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Statistics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Statistics/Probability%20Basics.html">Probability Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Statistics/Probability%20Distribution.html">Probability Distribution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Statistics/Central%20Limit%20Theorem.html">Central Limit Theorem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Statistics/Bayesian%20vs%20Frequentist%20Reasoning.html">Bayesian vs Frequentist Reasoning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Statistics/Hypothesis%20Testing.html">Hypothesis Testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Data/Scaling.html">Scaling</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Algorithms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Algorithms/Regression.html">Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Algorithms/Generative%20VS%20Discriminative%20Models.html">Generative vs Discriminative Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Algorithms/Classification.html">Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Algorithms/Time%20Series%20Analysis.html">Time Series Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Algorithms/Anomaly%20Detection.html">Anomaly Detection</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">NLP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../NLP/Lexical%20Processing.html">Lexical Processing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Basics.html">Basics</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Data Manipulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Statistics.html">Statistics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SQL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../SQL/Select.html">SQL Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SQL/Joins.html">Joins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SQL/Temporary%20Datasets.html">Temporary Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SQL/Windows%20Functions.html">Windows Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SQL/Time.html">Time</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SQL/Functions.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SQL/Problems.html">Problems</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Excel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Excel/Excel%20Basics.html">Excel Basics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tensorflow</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Tensorflow/Basics.html">Basics</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analytical Thinking</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Analytical%20Thinking/Business%20Scenarios.html">Business Scenarios</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="data-manipulation">
<h1>Data Manipulation<a class="headerlink" href="#data-manipulation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="questions">
<h2>Questions<a class="headerlink" href="#questions" title="Permalink to this headline">¶</a></h2>
<div class="dropdown tip admonition">
<p class="admonition-title">Problem: [GOOGLE] Score Bucketization</p>
<p>Let’s say you’re given a list of standardized test scores from high schoolers from grades <span class="math notranslate nohighlight">\(9\)</span> to <span class="math notranslate nohighlight">\(12\)</span>.</p>
<p>Given the dataset, write code in Pandas to return the cumulative percentage of students that received scores within the buckets of <span class="math notranslate nohighlight">\(&lt;50, &lt;75, &lt;90, &lt;100\)</span>.</p>
<p>Example Input:</p>
<div class="table-wrapper"><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>user_id</p></th>
<th class="head"><p>grade</p></th>
<th class="head"><p>test score</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>10</p></td>
<td><p>85</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>10</p></td>
<td><p>60</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>11</p></td>
<td><p>90</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>10</p></td>
<td><p>30</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>11</p></td>
<td><p>99</p></td>
</tr>
</tbody>
</table></div>
<p>Example Output:</p>
<div class="table-wrapper"><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>grade</p></th>
<th class="head"><p>test score</p></th>
<th class="head"><p>percentage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>10</p></td>
<td><p>&lt;50</p></td>
<td><p>30%</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>&lt;75</p></td>
<td><p>65%</p></td>
</tr>
<tr class="row-even"><td><p>10</p></td>
<td><p>&lt;90</p></td>
<td><p>96%</p></td>
</tr>
<tr class="row-odd"><td><p>10</p></td>
<td><p>&lt;100</p></td>
<td><p>99%</p></td>
</tr>
<tr class="row-even"><td><p>11</p></td>
<td><p>&lt;50</p></td>
<td><p>15%</p></td>
</tr>
<tr class="row-odd"><td><p>11</p></td>
<td><p>&lt;75</p></td>
<td><p>50%</p></td>
</tr>
</tbody>
</table></div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">85</span><span class="p">],[</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">60</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">90</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">30</span><span class="p">],[</span><span class="mi">5</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">99</span><span class="p">]],</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"user_id"</span><span class="p">,</span><span class="s2">"grade"</span><span class="p">,</span><span class="s2">"test score"</span><span class="p">])</span>

<span class="n">df</span><span class="p">[</span><span class="s2">"&lt;50"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"test score"</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">50</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"&lt;75"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"test score"</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">75</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"&lt;90"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"test score"</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">90</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"&lt;100"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">"test score"</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">"grade"</span><span class="p">])[[</span><span class="s2">"&lt;50"</span><span class="p">,</span><span class="s2">"&lt;75"</span><span class="p">,</span><span class="s2">"&lt;90"</span><span class="p">,</span><span class="s2">"&lt;100"</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s2">"grade"</span><span class="p">],</span><span class="n">var_name</span><span class="o">=</span><span class="s2">"test score"</span><span class="p">,</span><span class="n">value_name</span><span class="o">=</span><span class="s2">"count"</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s2">"grp_ttl"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">"grade"</span><span class="p">)[</span><span class="s2">"count"</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">'max'</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"percentage"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s2">"count"</span><span class="p">]</span><span class="o">/</span><span class="n">df</span><span class="p">[</span><span class="s2">"grp_ttl"</span><span class="p">]</span>

<span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s2">"grade"</span><span class="p">,</span><span class="s2">"test score"</span><span class="p">,</span><span class="s2">"percentage"</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span><span class="o">.</span><span class="n">sort_values</span><span class="p">([</span><span class="s2">"grade"</span><span class="p">,</span><span class="s2">"percentage"</span><span class="p">],</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s2">"percentage"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">percentage</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s2">"percentage"</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">"percentage"</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"%"</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>grade</th>
<th>test score</th>
<th>percentage</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>10</td>
<td>&lt;50</td>
<td>33%</td>
</tr>
<tr>
<th>2</th>
<td>10</td>
<td>&lt;75</td>
<td>66%</td>
</tr>
<tr>
<th>4</th>
<td>10</td>
<td>&lt;90</td>
<td>100%</td>
</tr>
<tr>
<th>6</th>
<td>10</td>
<td>&lt;100</td>
<td>100%</td>
</tr>
<tr>
<th>1</th>
<td>11</td>
<td>&lt;50</td>
<td>0%</td>
</tr>
<tr>
<th>3</th>
<td>11</td>
<td>&lt;75</td>
<td>0%</td>
</tr>
<tr>
<th>5</th>
<td>11</td>
<td>&lt;90</td>
<td>0%</td>
</tr>
<tr>
<th>7</th>
<td>11</td>
<td>&lt;100</td>
<td>100%</td>
</tr>
</tbody>
</table></div>
</div></div></div>
</div>
<div class="dropdown tip admonition">
<p class="admonition-title">Problem: [NEXTDOOR] Complete Addresses</p>
<p>You’re given two dataframes. One contains information about addresses and the other contains relationships between various cities and states:</p>
<p>df_addresses</p>
<p>address</p>
<p>4860 Sunset Boulevard, San Francisco, 94105
3055 Paradise Lane, Salt Lake City, 84103
682 Main Street, Detroit, 48204
9001 Cascade Road, Kansas City, 64102
5853 Leon Street, Tampa, 33605</p>
<p>df_cities</p>
<p>city	state
Salt Lake City	Utah
Kansas City	Missouri
Detroit	Michigan
Tampa	Florida
San Francisco	California</p>
<p>Write a function complete_address to create a single dataframe with complete addresses in the format of street, city, state, zipcode.</p>
<p>Input:</p>
<p>import pandas as pd</p>
<p>addresses = {“address”: [“4860 Sunset Boulevard, San Francisco, 94105”, “3055 Paradise Lane, Salt Lake City, 84103”, “682 Main Street, Detroit, 48204”, “9001 Cascade Road, Kansas City, 64102”, “5853 Leon Street, Tampa, 33605”]}</p>
<p>cities = {“city”: [“Salt Lake City”, “Kansas City”, “Detroit”, “Tampa”, “San Francisco”], “state”: [“Utah”, “Missouri”, “Michigan”, “Florida”, “California”]}</p>
<p>df_addresses = pd.DataFrame(addresses)
df_cities = pd.DataFrame(cities)</p>
<p>Output:</p>
<p>def complete_address(df_addresses,df_cities) -&gt;</p>
<p>address
4860 Sunset Boulevard, San Francisco, California, 94105
3055 Paradise Lane, Salt Lake City, Utah, 84103
682 Main Street, Detroit, Michigan, 48204
9001 Cascade Road, Kansas City, Missouri, 64102
5853 Leon Street, Tampa, Florida, 33605</p>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">addresses</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"address"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"4860 Sunset Boulevard, San Francisco, 94105"</span><span class="p">,</span> <span class="s2">"3055 Paradise Lane, Salt Lake City, 84103"</span><span class="p">,</span> <span class="s2">"682 Main Street, Detroit, 48204"</span><span class="p">,</span> <span class="s2">"9001 Cascade Road, Kansas City, 64102"</span><span class="p">,</span> <span class="s2">"5853 Leon Street, Tampa, 33605"</span><span class="p">]}</span>

<span class="n">cities</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"city"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Salt Lake City"</span><span class="p">,</span> <span class="s2">"Kansas City"</span><span class="p">,</span> <span class="s2">"Detroit"</span><span class="p">,</span> <span class="s2">"Tampa"</span><span class="p">,</span> <span class="s2">"San Francisco"</span><span class="p">],</span> <span class="s2">"state"</span><span class="p">:</span> <span class="p">[</span><span class="s2">"Utah"</span><span class="p">,</span> <span class="s2">"Missouri"</span><span class="p">,</span> <span class="s2">"Michigan"</span><span class="p">,</span> <span class="s2">"Florida"</span><span class="p">,</span> <span class="s2">"California"</span><span class="p">]}</span>

<span class="n">df_addresses</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">addresses</span><span class="p">)</span>
<span class="n">df_cities</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cities</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">complete_address</span><span class="p">(</span><span class="n">df_addresses</span><span class="p">,</span><span class="n">df_cities</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">df_addresses</span><span class="p">[</span><span class="s1">'address'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">", "</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">expand</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'street'</span><span class="p">,</span><span class="s1">'city'</span><span class="p">,</span><span class="s1">'zip'</span><span class="p">]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_cities</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s2">"city"</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s2">"inner"</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="s2">"final"</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[[</span><span class="s2">"street"</span><span class="p">,</span><span class="s2">"city"</span><span class="p">,</span><span class="s2">"state"</span><span class="p">,</span><span class="s2">"zip"</span><span class="p">]]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="s2">", "</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[[</span><span class="s2">"final"</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"address"</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">temp</span>

<span class="n">complete_address</span><span class="p">(</span><span class="n">df_addresses</span><span class="p">,</span><span class="n">df_cities</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<div class="table-wrapper"><table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>address</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>4860 Sunset Boulevard, San Francisco, Californ...</td>
</tr>
<tr>
<th>1</th>
<td>3055 Paradise Lane, Salt Lake City, Utah, 84103</td>
</tr>
<tr>
<th>2</th>
<td>682 Main Street, Detroit, Michigan, 48204</td>
</tr>
<tr>
<th>3</th>
<td>9001 Cascade Road, Kansas City, Missouri, 64102</td>
</tr>
<tr>
<th>4</th>
<td>5853 Leon Street, Tampa, Florida, 33605</td>
</tr>
</tbody>
</table></div>
</div></div></div>
</div>
<div class="tip dropdown admonition">
<p class="admonition-title">Problem: PANDAS vs SQL</p>
<p>Can you tell me what is approximately Windows function equivalent in Pandas?</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Solution:</p>
<p>Windows function in SQL brings row wise calculation capabilities. An approximate equivalent of it can be <code class="docutils literal notranslate"><span class="pre">transform</span></code> in pandas it brings row wise calculation capabilities in Python.</p>
</div>
</div>
</div>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./contents\Python"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="Statistics.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Statistics</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="Basics.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Basics</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; MIT License |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="../../_sources/contents/Python/Data Manipulation.ipynb"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Data Manipulation</a><ul>
<li><a class="reference internal" href="#questions">Questions</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/main.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    </body>
</html>